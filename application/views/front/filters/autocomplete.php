	<div>		<div class="ui-widget">			<label for="{hash}">{label}</label>			<input type="text" name="autocomplete[{name}][{cast}]" id="{hash}" style="width:400px;" />		</div>	</div>	<style>	.ui-autocomplete-loading { background: white url(<?php _a('css/ui-lightness/images/ui-anim_basic_16x16.gif'); ?>) right center no-repeat; }	</style><script type="text/javascript">	$(function() {				var cache = {},			lastXhr;		$( "#{hash}" )		.bind( "keydown", function( event ) {				if ( event.keyCode === $.ui.keyCode.TAB &&						$( this ).data( "autocomplete" ).menu.active ) {					event.preventDefault();				}		})		.autocomplete({			minLength: 3,			source: function( request, response )			{				var term = request.term.split( /,\s*/ ).pop();				request.term = term;								if ( term in cache ) {					response( cache[ term ] );					return;				}								lastXhr = $.getJSON( "/shite/www/01/item/ajax/autocomplete/loc/city", request, function( data, status, xhr )				{					cache[ term ] = data;					if ( xhr === lastXhr )					{						response( data );					}				});			},			search: function() {				// splitto term e tengo solo l'ultimo termine di ricerca				var term = this.value.split( /,\s*/ ).pop();				if(term.length < 3) return false;			},			focus: function() {				// prevent value inserted on focus				return false;			},			select: function( event, ui ) {				var terms = this.value.split( /,\s*/ );				// remove the current input				terms.pop();				// add the selected item				terms.push( ui.item.value );				// add placeholder to get the comma-and-space at the end				terms.push( "" );				this.value = terms.join( ", " );								// aggiorno minLength				this.minLength = parseInt($('#{hash}').val().length) + 2;								return false;			}		});	});</script>